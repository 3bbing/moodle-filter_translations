define ("filter_translations/translation_button",["jquery","core/modal_factory","core/str","core/templates"],function(a,b,c,d){var e={returnurl:"",init:function init(b){e.returnurl=b;e.findandinjectbuttons();a("body").on("click",".filter_translations_btn_translate",e.opentranslation);a("body").on("contextmenu",".filter_translations_btn_translate",e.opentranslation)},findandinjectbuttons:function findandinjectbuttons(){var b=e.findElementsDirectlyContainingText(document,"\u200D\u200D");b.forEach(function(b){var c=/‍‍([​‌]*)/.exec(a(b).html())[1].replace(/​/g,"1").replace(/‌/g,"0"),f=parseInt(c,2);d.render("filter_translations/translatebutton",{inpagetranslationid:f}).done(function(c){a(b).append(c);var d=e.objects[f];if(d.staletranslation){a(".filter_translations_btn_translate[data-inpagetranslationid="+f+"]").addClass("alert-warning")}else if(d.goodtranslation){a(".filter_translations_btn_translate[data-inpagetranslationid="+f+"]").addClass("alert-success")}})})},opentranslation:function opentranslation(f){f.stopPropagation();f.preventDefault();var g=e.objects[a(this).data("inpagetranslationid")];g.returnurl=e.returnurl;c.get_strings([{key:"translationdetails",component:"filter_translations"}]).then(function(a){return d.render("filter_translations/translationdetailsmodalbody",g).done(function(c){b.create({title:a[0],body:c,type:b.types.ALERT}).then(function(a){a.show()})})}).fail(Notification.exception)},register:function register(b,c){e.objects[b]=c;if(c.staletranslation){a(".filter_translations_btn_translate[data-inpagetranslationid="+b+"]").addClass("alert-warning")}else if(c.goodtranslation){a(".filter_translations_btn_translate[data-inpagetranslationid="+b+"]").addClass("alert-success")}},findElementsDirectlyContainingText:function findElementsDirectlyContainingText(a,b){var d=[];c(a);return d;function c(a){for(var e=a.childNodes.length,f=0,g;f<e;f++){g=a.childNodes[f];if(3===g.nodeType&&-1!==g.data.indexOf(b)){d.push(a);break}}for(var f=0,g;f<e;f++){g=a.childNodes[f];if(1===g.nodeType){c(g)}}}},objects:{}};return e});
//# sourceMappingURL=translation_button.min.js.map
