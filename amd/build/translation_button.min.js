define ("filter_translations/translation_button",["jquery","core/modal_factory","core/str","core/templates"],function(a,b,c,d){var e={returnurl:"",init:function init(b){e.returnurl=b;a("body").on("click",".filter_translations_btn_translate",e.opentranslation);a("body").on("contextmenu",".filter_translations_btn_translate",e.opentranslation)},findandinjectbuttons:function findandinjectbuttons(){var b=e.findElementsDirectlyContainingText(document,"\u200D\u200D");b.forEach(function(b){var c=/‍‍([​‌]*)/.exec(a(b).html())[1].replace(/​/g,"1").replace(/‌/g,"0"),f=parseInt(c,2),g=e.objects[f];d.render("filter_translations/translatebutton",g).done(function(c){a(b).append(c)})});var c=0,f=0;for(var g in e.objects){if(e.objects[g].staletranslation){c+=1}else if(e.objects[g].notranslation){f+=1}}var h=c+f;a(".translation-icon-wrapper i").after("<div class=\"count-container \" data-region=\"count-container\">"+e.cap_count(h)+"</div>");a(".translation-icon-wrapper a.missingonthispage").html(a(".translation-icon-wrapper a.missingonthispage").html()+" ("+e.cap_count(f)+")");a(".translation-icon-wrapper a.staleonthispage").html(a(".translation-icon-wrapper a.staleonthispage").html()+" ("+e.cap_count(c)+")")},opentranslation:function opentranslation(f){f.stopPropagation();f.preventDefault();var g=e.objects[a(this).data("inpagetranslationid")];g.returnurl=e.returnurl;c.get_strings([{key:"translationdetails",component:"filter_translations"}]).then(function(a){return d.render("filter_translations/translationdetailsmodalbody",g).done(function(c){b.create({title:a[0],body:c,type:b.types.ALERT}).then(function(a){a.show()})})}).fail(Notification.exception)},register:function register(a,b){e.objects[a]=b},findElementsDirectlyContainingText:function findElementsDirectlyContainingText(a,b){var d=[];c(a);return d;function c(a){for(var e=a.childNodes.length,f=0,g;f<e;f++){g=a.childNodes[f];if(3===g.nodeType&&-1!==g.data.indexOf(b)){d.push(a);break}}for(var f=0,g;f<e;f++){g=a.childNodes[f];if(1===g.nodeType){c(g)}}}},cap_count:function cap_count(a){if(100>a){return a}else{return"99+"}},objects:{}};return e});
//# sourceMappingURL=translation_button.min.js.map
